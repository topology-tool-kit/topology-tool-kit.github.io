
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.4.0">
    
    
      
        <title>Clustering Kelvin Helmholtz Instabilities - TTK Examples</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.69437709.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#clustering-kelvin-helmholtz-instabilities" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="TTK Examples" class="md-header__button md-logo" aria-label="TTK Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            TTK Examples
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Clustering Kelvin Helmholtz Instabilities
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="teal"  aria-hidden="true"  type="radio" name="__palette" id="__palette_1">
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="TTK Examples" class="md-nav__button md-logo" aria-label="TTK Examples" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    TTK Examples
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Welcome to the TTK Examples!
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../1manifoldLearning/" class="md-nav__link">
        1-Manifold Learning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../1manifoldLearningCircles/" class="md-nav__link">
        1-Manifold Learning Circles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../2manifoldLearning/" class="md-nav__link">
        2-Manifold Learning
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../BuiltInExample1/" class="md-nav__link">
        Builtin example 1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../builtInExample2/" class="md-nav__link">
        Builtin example 2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../cinemaIO/" class="md-nav__link">
        CinemaIO
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Clustering Kelvin Helmholtz Instabilities
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Clustering Kelvin Helmholtz Instabilities
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipeline-description" class="md-nav__link">
    Pipeline description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#paraview" class="md-nav__link">
    ParaView
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-code" class="md-nav__link">
    Python code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    Inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpython-api" class="md-nav__link">
    C++/Python API
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../contourTreeAlignment/" class="md-nav__link">
        Contour Tree Alignment
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../ctBones/" class="md-nav__link">
        CT bones
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../dragon/" class="md-nav__link">
        Dragon
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../geometryApproximation/" class="md-nav__link">
        Geometry Approximation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../harmonicSkeleton/" class="md-nav__link">
        Harmonic Skeleton
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../imageProcessing/" class="md-nav__link">
        Image Processing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../interactionSites/" class="md-nav__link">
        Interaction sites
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../karhunenLoveDigits64Dimensions/" class="md-nav__link">
        Karhunen-Love Digits 64-Dimensions
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../manifoldCheck/" class="md-nav__link">
        Manifold Check
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mergeTreeClustering/" class="md-nav__link">
        Merge Tree Clustering
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../mergeTreeTemporalReduction/" class="md-nav__link">
        Merge Tree Temporal Reduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../morseMolecule/" class="md-nav__link">
        Morse molecule
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../morsePersistence/" class="md-nav__link">
        Morse persistence
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../morseSmaleQuadrangulation/" class="md-nav__link">
        Morse-Smale Quadrangulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../nestedTrackingFromOverlap/" class="md-nav__link">
        Nested Tracking From Overlap
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClustering0/" class="md-nav__link">
        Persistence Clustering 0
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClustering1/" class="md-nav__link">
        Persistence Clustering 1
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClustering2/" class="md-nav__link">
        Persistence Clustering 2
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClustering3/" class="md-nav__link">
        Persistence Clustering 3
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClustering4/" class="md-nav__link">
        Persistence Clustering 4
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceClusteringGallery/" class="md-nav__link">
        Persistence Clustering Gallery
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceDiagramClustering/" class="md-nav__link">
        Persistence Diagram Clustering
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceDiagramDistance/" class="md-nav__link">
        Persistence Diagram Distance
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistenceDrivenCompression/" class="md-nav__link">
        Persistence-Driven Compression
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_at/" class="md-nav__link">
        Persistent Generators AT
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_casting/" class="md-nav__link">
        Persistent Generators Casting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_darkSky/" class="md-nav__link">
        Persistent Generators DarkSky
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_fertility/" class="md-nav__link">
        Persistent Generators Fertility
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_householdAnalysis/" class="md-nav__link">
        Persistent Generators Household Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_periodicPicture/" class="md-nav__link">
        Persistent Generators Periodic Picture
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../persistentGenerators_skull/" class="md-nav__link">
        Persistent Generators Skull
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tectonicPuzzle/" class="md-nav__link">
        Tectonic Puzzle
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../timeTracking/" class="md-nav__link">
        Time Tracking
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../tribute/" class="md-nav__link">
        Tribute to Edelsbrunner and Harer's book
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../uncertainStartingVortex/" class="md-nav__link">
        Uncertain Starting Vortex
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pipeline-description" class="md-nav__link">
    Pipeline description
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#paraview" class="md-nav__link">
    ParaView
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#python-code" class="md-nav__link">
    Python code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inputs" class="md-nav__link">
    Inputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#outputs" class="md-nav__link">
    Outputs
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cpython-api" class="md-nav__link">
    C++/Python API
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="clustering-kelvin-helmholtz-instabilities">Clustering Kelvin Helmholtz Instabilities<a class="headerlink" href="#clustering-kelvin-helmholtz-instabilities" title="Permanent link">&para;</a></h1>
<iframe width="100%" height="420"
src="https://www.youtube.com/embed/EROXnZ5MuU0" frameborder="0"
allowfullscreen></iframe>

<h2 id="pipeline-description">Pipeline description<a class="headerlink" href="#pipeline-description" title="Permanent link">&para;</a></h2>
<p>This example illustrates the capabilities of 
<a href="https://topology-tool-kit.github.io/">TTK</a> to perform advanced statistical 
analysis of collections of datasets, based on their structural representations, 
along with the possibility to interactively explore the outcome of the analysis, 
with linked views (between the selection in the planar view -- top right -- and 
the flow visualization -- top left).</p>
<p>This example considers an ensemble of 32 periodic, 2D Kelvin Helmholtz 
Instabilities in computational fluid dynamics, obtained with various simulation 
parameters (different solvers, different numerical schemes, different 
interpolation orders, etc.). 
The scalar field of interest is the "Enstrophy". It is an established measure 
of vorticity. Its prominent maxima denote the center of strong vortices.
Two example members from 
the ensemble are show on the above screenshot (left). Strong vortices can be 
visualized with the dark green regions.
The simulation parameters as well as the ground truth classification are 
provided as metadata for each entry of the database and are carried along the 
entire pipeline.
See this <a href="https://arxiv.org/abs/2207.14080">publication</a> for 
further details.</p>
<p>The goal of this example is to classify the 32 members of the ensemble into two 
classes, whether they 
describe
the beginning or the end of 
the turbulence. This task is particularly challenging for traditional 
clustering pipelines since turbulent flows are highly chaotic and two flows 
belonging to the same ground truth class can be drastically different visually 
(as shown on the above screenshot -- left). The common denominator between two 
turbulent flows in the same ground truth class is the distribution of energies 
of their vortices (i.e. the number and strengths of their vortices), which 
describes the turbulence of the flow.</p>
<p>In this context, topological data representations are particularly relevant to 
extract such subtle structural features. In particular, the persistence diagram 
involving the saddle-maximum pairs of the "Enstrophy" (second column, above 
screenshot) nicely captures the number of vortices as well as their individual 
strengths. Thus, in the reminder of this example, we will use this persistence 
diagram as a descriptor of each turbulent flow and we will proceed to a k-means 
clustering directly in the Wasserstein metric space of persistence diagrams. 
For visualization purposes, we will compute a 2D layout of the ensemble (right 
most columns, above screenshot) to inspect the resulting classification.</p>
<p>First, the database of turbulent flows is loaded from disk with the 
<a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaReader.html">CinemaReader</a>
module (line 6 of the <a href="#python-code">Python</a> script below). Then an SQL 
query is performed with 
<a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaQuery.html">CinemaQuery</a>
to select a relevant subset of this database (line 9). Finally the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaProductReader.html">CinemaProductReader</a>
is used to read the actual regular grids 
corresponding to the result of the previous SQL query. From this point on, the 
entire set of 32 turbulent flows will be organized as a 
<a href="https://vtk.org/doc/nightly/html/classvtkMultiBlockDataSet.html">vtkMultiBlockDatSet</a>
and each of these 32 members will be processed by the rest of the 
analysis pipeline.</p>
<p>Then for each of the 32 members of the ensemble, the first step consists in 
marking periodicity boundary conditions with the 
<a href="https://topology-tool-kit.github.io/doc/html/classttkTriangulationManager.html">TriangulationManager</a> 
(line 21). Next, the "Enstrophy" field of 
each member is normalized (between 0 and 1) with the 
<a href="https://topology-tool-kit.github.io/doc/html/classttkScalarFieldNormalizer.html">ScalarFieldNormalizer</a>
to ease their comparison later. Finally 
(line 28) the 
<a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagram.html">PersistenceDiagram</a>
is computed (for the saddle-maximum pairs) to 
represent each of the 32 ensemble members by a diagram which encodes the number 
and the strengths of the vortices via the persistence of the maxima of 
"Enstrophy".</p>
<p>Next, the clustering of the persistence diagrams in the Wasserstein metric 
space is performed with the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagramClustering.html">PersistenceDiagramClustering</a>
(line 32).</p>
<p>For visualization purposes, we will then compute a 2D layout of the ensemble, 
where each ensemble member will be represented by a point and where the 2D 
distance between 2 points will encode the Wasserstein distance between their 
diagrams. This will provide an intuitive planar overview of the ensemble.
For this, we will first compute a matrix of Wasserstein distances 
with the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagramDistanceMatrix.html">PersistenceDiagramDistanceMatrix</a>
(line 39). The resulting 
distance matrix is visualized at the bottom of the middle column in the above 
screenshot. There, it can be seen that the Wasserstein distance already 
identifies two major clusters (large blue sub-matrices of low Wasserstein 
distances).
Next (line 67), 
the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkDimensionReduction.html">DimensionReduction</a>
is used to compute a 2D layout via 
multidimensional scaling. Finally, the resulting table is turned into a 2D 
point cloud which is ready to be visualized with
<a href="https://kitware.github.io/paraview-docs/latest/python/paraview.simple.TableToPoints.html">TableToPoints</a>
(line 75). Then, the output is stored to a simple 
CSV file (line 81).</p>
<p>In the above screenshot, the resulting point cloud is shown in the 2 views at<br />
the bottom right corner of the screenshot. The first view (left) shows the 
point cloud colored by cluster identifier computed by the pipeline. The second 
view (right) show the same point cloud, colored by the ground truth class. 
There, one can directly visualize that the two classifications are identical 
and that, therefore, this topological clustering pipeline succeeded.</p>
<p>For reference, a traditional pipeline based on the L2-distance between the 
"Entrophy" fields is also provided in this example.
For that, the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkLDistanceMatrix.html">LDistanceMatrix</a>
is used (line 45) to compute a matrix of the L2 
distances between each scalar field of the ensemble. 
The resulting distance matrix is visualized at the top of the middle column 
in the above screenshot. There, it can be seen that the L2 distance between the 
scalar fields fails at identifying any clear clusters (there are no large blue 
sub-matrices).
Next (line 49), the module 
<a href="https://topology-tool-kit.github.io/doc/html/classttkDimensionReduction.html">DimensionReduction</a>
is used to compute a 2D layout via 
multidimensional scaling. The resulting table is turned into a 2D point cloud 
with 
<a href="https://kitware.github.io/paraview-docs/latest/python/paraview.simple.TableToPoints.html">TableToPoints</a>
(line 55). Finally, the k-means algorithm is run on 
this 2D point cloud with the module 
<a href="https://kitware.github.io/paraview-docs/latest/python/paraview.simple.KMeans.html">KMeans</a>.
Then, the output is stored to a simple 
CSV file (line 83).
The resulting clustering can be visualized with the two views at 
the top right corner of the above screenshot. The ground-truth classification 
is provided by the color coding of the points in the second view (right) while 
the classification computed with this traditional pipeline is shown in the 
first view (left). There, it can bee seen that the coloring of the two point 
clouds differ, indicating an incorrect classification by the traditional kMeans 
algorithm. In particular, since all the metadata associated with each ensemble 
member travels down the analysis pipeline, one can select points in these 
planar views to inspect the corresponding datasets and persistence diagrams 
(left two columns of the screenshot). In particular, two members (red and 
yellow spheres) incorrectly marked as belonging to different classes are 
visualized on the left. There, one can see that although the two flows have the 
same "profile" of vortices (number and strengths), these are located in 
drastically different spots of the field, due to the chaotic nature of 
turbulence, hence explaining the reason of failure of traditional 
clustering pipelines.</p>
<h2 id="paraview">ParaView<a class="headerlink" href="#paraview" title="Permanent link">&para;</a></h2>
<p>To reproduce the above screenshot, go to your <a href="https://github.com/topology-tool-kit/ttk-data">ttk-data</a> directory and enter the following command:
<div class="highlight"><pre><span></span><code>paraview --state<span class="o">=</span>states/clusteringKelvinHelmholtzInstabilities.pvsm 
</code></pre></div></p>
<h2 id="python-code">Python code<a class="headerlink" href="#python-code" title="Permanent link">&para;</a></h2>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#!/usr/bin/env python</span>

<span class="kn">from</span> <span class="nn">paraview.simple</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># create a new &#39;TTK CinemaReader&#39;</span>
<span class="n">tTKCinemaReader1</span> <span class="o">=</span> <span class="n">TTKCinemaReader</span><span class="p">(</span><span class="n">DatabasePath</span><span class="o">=</span><span class="s2">&quot;khi.cdb&quot;</span><span class="p">)</span>

<span class="c1"># create a new &#39;TTK CinemaQuery&#39;</span>
<span class="n">tTKCinemaQuery1</span> <span class="o">=</span> <span class="n">TTKCinemaQuery</span><span class="p">(</span><span class="n">InputTable</span><span class="o">=</span><span class="n">tTKCinemaReader1</span><span class="p">)</span>
<span class="n">tTKCinemaQuery1</span><span class="o">.</span><span class="n">SQLStatement</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    SELECT * FROM InputTable0</span>
<span class="s2">        WHERE Resolution=&#39;512&#39; </span>
<span class="s2">            AND (Time=&#39;0&#39; OR Time=&#39;2&#39;) </span>
<span class="s2">            AND (NOT (Solver=&#39;hll&#39;))&quot;&quot;&quot;</span>

<span class="c1"># create a new &#39;TTK CinemaProductReader&#39;</span>
<span class="n">tTKCinemaProductReader1</span> <span class="o">=</span> <span class="n">TTKCinemaProductReader</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKCinemaQuery1</span><span class="p">)</span>

<span class="c1"># create a new &#39;TTK TriangulationManager&#39;</span>
<span class="n">tTKTriangulationManager1</span> <span class="o">=</span> <span class="n">TTKTriangulationManager</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKCinemaProductReader1</span><span class="p">)</span>
<span class="n">tTKTriangulationManager1</span><span class="o">.</span><span class="n">PeriodicityinAllDimensions</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># create a new &#39;TTK ScalarFieldNormalizer&#39;</span>
<span class="n">tTKScalarFieldNormalizer1</span> <span class="o">=</span> <span class="n">TTKScalarFieldNormalizer</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKTriangulationManager1</span><span class="p">)</span>
<span class="n">tTKScalarFieldNormalizer1</span><span class="o">.</span><span class="n">ScalarField</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;POINTS&quot;</span><span class="p">,</span> <span class="s2">&quot;Enstrophy&quot;</span><span class="p">]</span>

<span class="c1"># create a new &#39;TTK PersistenceDiagram&#39;</span>
<span class="n">tTKPersistenceDiagram1</span> <span class="o">=</span> <span class="n">TTKPersistenceDiagram</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKScalarFieldNormalizer1</span><span class="p">)</span>
<span class="n">tTKPersistenceDiagram1</span><span class="o">.</span><span class="n">ScalarField</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;POINTS&quot;</span><span class="p">,</span> <span class="s2">&quot;Enstrophy&quot;</span><span class="p">]</span>

<span class="c1"># create a new &#39;TTK PersistenceDiagramClustering&#39;</span>
<span class="n">tTKPersistenceDiagramClustering1</span> <span class="o">=</span> <span class="n">TTKPersistenceDiagramClustering</span><span class="p">(</span>
    <span class="n">Input</span><span class="o">=</span><span class="n">tTKPersistenceDiagram1</span>
<span class="p">)</span>
<span class="n">tTKPersistenceDiagramClustering1</span><span class="o">.</span><span class="n">Criticalpairsusedfortheclustering</span> <span class="o">=</span> <span class="s2">&quot;saddle-max pairs&quot;</span>
<span class="n">tTKPersistenceDiagramClustering1</span><span class="o">.</span><span class="n">Numberofclusters</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># create a new &#39;TTK PersistenceDiagramDistanceMatrix&#39;</span>
<span class="n">tTKPersistenceDiagramDistanceMatrix1</span> <span class="o">=</span> <span class="n">TTKPersistenceDiagramDistanceMatrix</span><span class="p">(</span>
    <span class="n">Input</span><span class="o">=</span><span class="n">tTKPersistenceDiagramClustering1</span>
<span class="p">)</span>
<span class="n">tTKPersistenceDiagramDistanceMatrix1</span><span class="o">.</span><span class="n">Criticalpairsused</span> <span class="o">=</span> <span class="s2">&quot;saddle-max pairs&quot;</span>

<span class="c1"># create a new &#39;TTK LDistanceMatrix&#39;</span>
<span class="n">tTKLDistanceMatrix1</span> <span class="o">=</span> <span class="n">TTKLDistanceMatrix</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKCinemaProductReader1</span><span class="p">)</span>
<span class="n">tTKLDistanceMatrix1</span><span class="o">.</span><span class="n">ScalarField</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;POINTS&quot;</span><span class="p">,</span> <span class="s2">&quot;Enstrophy&quot;</span><span class="p">]</span>

<span class="c1"># create a new &#39;TTK DimensionReduction&#39;</span>
<span class="n">tTKDimensionReduction2</span> <span class="o">=</span> <span class="n">TTKDimensionReduction</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKLDistanceMatrix1</span><span class="p">)</span>
<span class="n">tTKDimensionReduction2</span><span class="o">.</span><span class="n">Regexp</span> <span class="o">=</span> <span class="s2">&quot;Dataset.*&quot;</span>
<span class="n">tTKDimensionReduction2</span><span class="o">.</span><span class="n">SelectFieldswithaRegexp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tTKDimensionReduction2</span><span class="o">.</span><span class="n">InputIsaDistanceMatrix</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># create a new &#39;Table To Points&#39;</span>
<span class="n">tableToPoints2</span> <span class="o">=</span> <span class="n">TableToPoints</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKDimensionReduction2</span><span class="p">)</span>
<span class="n">tableToPoints2</span><span class="o">.</span><span class="n">XColumn</span> <span class="o">=</span> <span class="s2">&quot;Component_0&quot;</span>
<span class="n">tableToPoints2</span><span class="o">.</span><span class="n">YColumn</span> <span class="o">=</span> <span class="s2">&quot;Component_1&quot;</span>
<span class="n">tableToPoints2</span><span class="o">.</span><span class="n">a2DPoints</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tableToPoints2</span><span class="o">.</span><span class="n">KeepAllDataArrays</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># create a new &#39;K Means&#39;</span>
<span class="n">kMeans1</span> <span class="o">=</span> <span class="n">KMeans</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tableToPoints2</span><span class="p">)</span>
<span class="n">kMeans1</span><span class="o">.</span><span class="n">VariablesofInterest</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Component_0&quot;</span><span class="p">,</span> <span class="s2">&quot;Component_1&quot;</span><span class="p">]</span>
<span class="n">kMeans1</span><span class="o">.</span><span class="n">k</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># create a new &#39;TTK DimensionReduction&#39;</span>
<span class="n">tTKDimensionReduction1</span> <span class="o">=</span> <span class="n">TTKDimensionReduction</span><span class="p">(</span>
    <span class="n">Input</span><span class="o">=</span><span class="n">tTKPersistenceDiagramDistanceMatrix1</span>
<span class="p">)</span>
<span class="n">tTKDimensionReduction1</span><span class="o">.</span><span class="n">Regexp</span> <span class="o">=</span> <span class="s2">&quot;Diagram.*&quot;</span>
<span class="n">tTKDimensionReduction1</span><span class="o">.</span><span class="n">SelectFieldswithaRegexp</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tTKDimensionReduction1</span><span class="o">.</span><span class="n">InputIsaDistanceMatrix</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># create a new &#39;Table To Points&#39;</span>
<span class="n">tableToPoints1</span> <span class="o">=</span> <span class="n">TableToPoints</span><span class="p">(</span><span class="n">Input</span><span class="o">=</span><span class="n">tTKDimensionReduction1</span><span class="p">)</span>
<span class="n">tableToPoints1</span><span class="o">.</span><span class="n">XColumn</span> <span class="o">=</span> <span class="s2">&quot;Component_0&quot;</span>
<span class="n">tableToPoints1</span><span class="o">.</span><span class="n">YColumn</span> <span class="o">=</span> <span class="s2">&quot;Component_1&quot;</span>
<span class="n">tableToPoints1</span><span class="o">.</span><span class="n">a2DPoints</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">tableToPoints1</span><span class="o">.</span><span class="n">KeepAllDataArrays</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">SaveData</span><span class="p">(</span><span class="s2">&quot;W2clusteringAndW2dimensionReduction.csv&quot;</span><span class="p">,</span> <span class="n">tableToPoints1</span><span class="p">)</span>

<span class="n">SaveData</span><span class="p">(</span><span class="s2">&quot;L2dimensionReductionAndClustering.csv&quot;</span><span class="p">,</span> <span class="n">OutputPort</span><span class="p">(</span><span class="n">kMeans1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>
<h2 id="inputs">Inputs<a class="headerlink" href="#inputs" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="https://github.com/topology-tool-kit/ttk-data/tree/dev/khi.cdb">khi.cdb</a>: a 
cinema database containing 32 regular grids describing periodic, 2D Kelvin 
Helmholtz Instabilities (computational fluid dynamics). 
The scalar field of interest is the "Enstrophy" (an established measure of 
vorticity).
The simulation parameters as well as the ground truth classification (two 
classes: beginning or end of the turbulence) are provided as metadata for each 
entry of the database and are carried along the entire pipeline.
See this <a href="https://arxiv.org/abs/2207.14080">publication</a> for further details.</li>
</ul>
<h2 id="outputs">Outputs<a class="headerlink" href="#outputs" title="Permanent link">&para;</a></h2>
<ul>
<li>
<p><code>W2clusteringAndW2dimensionReduction.csv</code>: 2D point cloud representing the 
input ensemble (1 line = 1 member of the ensemble). The field <code>ClusterId</code> 
denotes the class identifier computed with a k-means clustering (with 
k=2) directly performed in the Wasserstein metric space of persistence 
diagrams. <em>After</em> that, the 2D layout of the points is computed by 
multidimensional scaling of the matrix of Wasserstein distances between 
persistence diagrams. With this technique, the output classification perfectly 
matches the ground-truth classification.</p>
</li>
<li>
<p><code>L2dimensionReductionAndClustering.csv</code>: 2D point cloud representing the 
input ensemble (1 line = 1 member of the ensemble). The field <code>ClosestId(0)</code> 
denotes the class identifier computed with a standard k-means clustering (with 
k=2) obtained <em>after</em> a 2D projection of the point cloud. In particular, 
the 2D layout of the points is computed by multidimensional scaling 
of the matrix of L2 distances between the Enstrophy fields. With this 
technique, the output classification does not match the ground-truth 
classification.</p>
</li>
</ul>
<h2 id="cpython-api">C++/Python API<a class="headerlink" href="#cpython-api" title="Permanent link">&para;</a></h2>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaProductReader.html">CinemaProductReader</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaQuery.html">CinemaQuery</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkCinemaReader.html">CinemaReader</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkDimensionReduction.html">DimensionReduction</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkLDistanceMatrix.html">LDistanceMatrix</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagram.html">PersistenceDiagram</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagramClustering.html">PersistenceDiagramClustering</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkPersistenceDiagramDistanceMatrix.html">PersistenceDiagramDistanceMatrix</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkScalarFieldNormalizer.html">ScalarFieldNormalizer</a></p>
<p><a href="https://topology-tool-kit.github.io/doc/html/classttkTriangulationManager.html">TriangulationManager</a></p>




              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../cinemaIO/" class="md-footer__link md-footer__link--prev" aria-label="Previous: CinemaIO" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              CinemaIO
            </div>
          </div>
        </a>
      
      
        
        <a href="../contourTreeAlignment/" class="md-footer__link md-footer__link--next" aria-label="Next: Contour Tree Alignment" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Contour Tree Alignment
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.9c69f0bc.min.js"></script>
      
    
  </body>
</html>